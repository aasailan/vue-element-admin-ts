webpackJsonp([5],{570:function(e,t,a){"use strict";function s(e){r||a(794)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(795),n=a(801),r=!1,o=a(6),c=s,l=o(i.a,n.a,!1,c,null,null);l.options.__file="src\\pages\\friendImpressions\\index.vue",l.esModule&&Object.keys(l.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)}),t.default=l.exports},591:function(e,t,a){"use strict";a.d(t,"b",function(){return s}),a.d(t,"a",function(){return i});var s=function(){function e(){this.content=null,this.tag0=null,this.tag1=null,this.tag2=null,this.tag3=null,this.tag4=null,this.tag5=null,this.privacy=null,this.uid=null}return e}(),i=function(){function e(e){for(var t in e)this[t]=e[t];this.tagsArray=[];for(var a=0;a<6;a++)null!==e["tag"+a]&&this.tagsArray.push(this["tag"+a])}return e}()},794:function(e,t){},795:function(e,t,a){"use strict";var s=a(12),i=a(55),n=a.n(i),r=a(582),o=a(796),c=a(581),l=a(110),u=a(61),d=a(36),h=a(591),p=a(60),v=a(25),f=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(t,a){function s(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(s.prototype=a.prototype,new s)}}(),m=this&&this.__decorate||function(e,t,a,s){var i,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,a):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,s);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(n<3?i(r):n>3?i(t,a,r):i(t,a))||r);return n>3&&r&&Object.defineProperty(t,a,r),r},g=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},y=this&&this.__awaiter||function(e,t,a,s){return new(a||(a=Promise))(function(i,n){function r(e){try{c(s.next(e))}catch(e){n(e)}}function o(e){try{c(s.throw(e))}catch(e){n(e)}}function c(e){e.done?i(e.value):new a(function(t){t(e.value)}).then(r,o)}c((s=s.apply(e,t||[])).next())})},b=this&&this.__generator||function(e,t){function a(e){return function(t){return s([e,t])}}function s(a){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,n&&(r=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(r=r.call(n,a[1])).done)return r;switch(n=0,r&&(a=[0,r.value]),a[0]){case 0:case 1:r=a;break;case 4:return c.label++,{value:a[1],done:!1};case 5:c.label++,n=a[1],a=[0];continue;case 7:a=c.ops.pop(),c.trys.pop();continue;default:if(r=c.trys,!(r=r.length>0&&r[r.length-1])&&(6===a[0]||2===a[0])){c=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){c.label=a[1];break}if(6===a[0]&&c.label<r[1]){c.label=r[1],r=a;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(a);break}r[2]&&c.ops.pop(),c.trys.pop();continue}a=t.call(e,c)}catch(e){a=[6,e],n=0}finally{i=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var i,n,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.userInfo=null,t.myselfInfo=null,t.curTime=null,t.commentList=[],t.topFriendImpression=null,t.initPageIndex=1,t.pageSize=5,t.privacyOptions=v.G,t.paramsCache=null,t.createCompleted=!1,t.isFriend=!1,t.isMe=!1,t.isFromLetter=!1,t.refreshingData=!1,t.loadingData=!1,t.loadingText=v.w,t.itemSelect=null,t.privacyTemp=null,t.radioValue=null,t.resPage={hasMore:!1,curPage:1},t.commentListContainer=null,t.popupInCommentView=!1,t}return f(t,e),t.prototype.create=function(){},t.prototype.activated=function(){return y(this,void 0,void 0,function(){var e;return b(this,function(t){switch(t.label){case 0:return[4,d.a.initedUser()];case 1:return t.sent(),e=this.$store.state.user.user,this.myselfInfo=e,this.paramsCache=this.$route.params,"recommendation"===this.paramsCache.action?(this.isFromLetter=!0,this.isFriend=!1,this.isMe=!1):(this.isFromLetter=!1,this.isFriend=d.a.isMyFriends(this.paramsCache.id),this.isMe=this.paramsCache.id===this.myselfInfo.uid),this.commentListContainer=this.$refs.commentListContainer,this.getCurUserInfo(),this.getTopFriendImpression(),this.refreshData(),this.popupInCommentView=!0,[2]}})})},t.prototype.deactivated=function(){this.popupInCommentView=!1,this.isShowModal&&this.closePrivacyModel()},t.prototype.tags=function(){return"tags"+Math.floor(13*Math.random())},t.prototype.getCurUserInfo=function(){return y(this,void 0,void 0,function(){var e,t;return b(this,function(a){switch(a.label){case 0:this.showLoading(),a.label=1;case 1:return a.trys.push([1,8,,9]),this.isMe?(this.userInfo=this.$store.state.user.user,[3,7]):[3,2];case 2:return e=void 0,"recommendation"!==this.paramsCache.action?[3,4]:[4,u.a.getOtherUserInfoByLetter(this.paramsCache.id)];case 3:return e=a.sent(),[3,6];case 4:return[4,u.a.getOtherUserInfo(this.paramsCache.id)];case 5:e=a.sent(),a.label=6;case 6:this.userInfo=e.body.obj,a.label=7;case 7:return this.hideLoading(),[3,9];case 8:return t=a.sent(),this.hideLoading(),this.showToast(new p.a(t.message)),[3,9];case 9:return[2]}})})},t.prototype.getTopFriendImpression=function(){return y(this,void 0,void 0,function(){var e,t;return b(this,function(a){switch(a.label){case 0:this.showLoading(),a.label=1;case 1:return a.trys.push([1,6,,7]),"recommendation"!==this.paramsCache.action?[3,3]:[4,u.a.getTopFriendImpressionByLetterId(this.paramsCache.id)];case 2:return e=a.sent(),[3,5];case 3:return[4,u.a.getTopFriendImpression(this.paramsCache.id)];case 4:e=a.sent(),a.label=5;case 5:return this.topFriendImpression={contents:e.body.obj.contents,tags:e.body.obj.tags},this.hideLoading(),[3,7];case 6:return t=a.sent(),this.hideLoading(),this.showToast(new p.a(t.message)),[3,7];case 7:return[2]}})})},t.prototype.refreshData=function(){return y(this,void 0,void 0,function(){var e,t,a;return b(this,function(s){switch(s.label){case 0:this.refreshingData=!0,s.label=1;case 1:return s.trys.push([1,8,9,10]),e=void 0,this.isMe?[4,u.a.getMyAllSentences(this.initPageIndex,this.pageSize)]:[3,3];case 2:return e=s.sent(),[3,7];case 3:return this.isFromLetter?[4,u.a.getOtherSentencesByLetterId(this.paramsCache.id,this.initPageIndex,this.pageSize)]:[3,5];case 4:return e=s.sent(),[3,7];case 5:return[4,u.a.getOtherAllSentences(this.paramsCache.id,this.initPageIndex,this.pageSize)];case 6:e=s.sent(),s.label=7;case 7:return this.commentList=this.tagsArrayTran(e.body.obj.rows),this.resPage=e.body.obj.page,t=e.body.obj.page,d.a.checkPage(this.resPage,t),[3,10];case 8:return a=s.sent(),this.showToast(new p.a(a.message)),[3,10];case 9:return this.refreshingData=!1,[7];case 10:return[2]}})})},t.prototype.loadMoreData=function(){return y(this,void 0,void 0,function(){var e,t,a,s;return b(this,function(i){switch(i.label){case 0:this.loadingData=!0,i.label=1;case 1:return i.trys.push([1,8,9,10]),e=void 0,this.isMe?[4,u.a.getMyAllSentences(this.resPage.curPage+1,this.pageSize)]:[3,3];case 2:return e=i.sent(),[3,7];case 3:return this.isFromLetter?[4,u.a.getOtherSentencesByLetterId(this.paramsCache.id,this.resPage.curPage+1,this.pageSize)]:[3,5];case 4:return e=i.sent(),[3,7];case 5:return[4,u.a.getOtherAllSentences(this.paramsCache.id,this.resPage.curPage+1,this.pageSize)];case 6:e=i.sent(),i.label=7;case 7:return t=e.body.obj.rows,this.commentList=this.commentList.concat(this.tagsArrayTran(t)),a=e.body.obj.page,d.a.checkPage(this.resPage,a),[3,10];case 8:return s=i.sent(),this.showToast(new p.a(s.message)),this.resPage.hasMore=!1,[3,10];case 9:return this.loadingData=!1,[7];case 10:return[2]}})})},t.prototype.tagsArrayTran=function(e){var t=[];return e.forEach(function(e){var a=new h.a(e);t.push(a)}),t},t.prototype.findUpvoterIndex=function(e,t){var a=-1;if(null===e)return a;for(var s=0;s<e.length;s++)if(e[s].uid===t){a=s;break}return a},t.prototype.isInUpvotersList=function(e){return null===e?-1:this.findUpvoterIndex(e,this.myselfInfo.uid)},t.prototype.changeLike=function(e,t){return y(this,void 0,void 0,function(){var a,s,i,n;return b(this,function(r){switch(r.label){case 0:return this.isFriend||this.isMe?(a=this.findUpvoterIndex(e,this.myselfInfo.uid),a>=0?[3,5]:[3,1]):[3,6];case 1:this.showLoading(),r.label=2;case 2:return r.trys.push([2,4,,5]),[4,u.a.updateSentencesUpvote(t)];case 3:return s=r.sent(),this.hideLoading(),i=s.body.obj,e.push(i),[3,5];case 4:return n=r.sent(),this.hideLoading(),this.showToast(new p.a(n.message)),[3,5];case 5:return[3,7];case 6:this.showToast(new p.a("您和ta不是好友，暂时无法点赞")),r.label=7;case 7:return[2]}})})},t.prototype.openPrivacyModal=function(e){this.itemSelect=e,this.privacyTemp=e.privacy+"",this.radioValue=e.privacy+"",this.addModal(v.D)},t.prototype.closePrivacyModel=function(){this.itemSelect=null,this.privacyTemp=null,this.radioValue=null,this.isShowModal&&this.hideModal()},t.prototype.udatePrivacy=function(e){return y(this,void 0,void 0,function(){var t,a,s;return b(this,function(i){switch(i.label){case 0:if(this.privacyTemp===e)return[3,5];this.showLoading(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,u.a.updateSentencesPrivacy(this.itemSelect.id,parseInt(e,10))];case 2:return t=i.sent(),a=t.body.obj,this.hideLoading(),this.itemSelect.privacy=parseInt(e,10),this.closePrivacyModel(),[3,4];case 3:return s=i.sent(),this.hideLoading(),this.showToast(new p.a("网络有问题，请检查后重试")),[3,4];case 4:return[3,6];case 5:this.closePrivacyModel(),i.label=6;case 6:return[2]}})})},t.prototype.routeToAddComment=function(){var e={id:this.userInfo.uid,sex:this.userInfo.sex,action:this.paramsCache.action};this.$router.push({name:"addComment",params:e})},m([Object(l.a)("showToast"),g("design:type",Object)],t.prototype,"showToast",void 0),m([Object(l.c)(function(e){return e.modal.MODAL_0}),g("design:type",Object)],t.prototype,"isShowModal",void 0),m([Object(l.a)("addModal"),g("design:type",Object)],t.prototype,"addModal",void 0),m([Object(l.a)("hideModal"),g("design:type",Object)],t.prototype,"hideModal",void 0),m([Object(l.a)("showLoading"),g("design:type",Object)],t.prototype,"showLoading",void 0),m([Object(l.a)("hideLoading"),g("design:type",Object)],t.prototype,"hideLoading",void 0),t=m([n()({components:{"mu-popup":r.a,"mu-radio":o.a,"mu-float-button":c.a}})],t)}(s.default);t.a=_},796:function(e,t,a){"use strict";var s=a(797);a.d(t,"a",function(){return s.a})},797:function(e,t,a){"use strict";function s(e){r||a(798)}var i=a(799),n=a(800),r=!1,o=a(6),c=s,l=o(i.a,n.a,!1,c,null,null);l.options.__file="node_modules\\muse-ui\\src\\radio\\radio.vue",l.esModule&&Object.keys(l.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)}),t.a=l.exports},798:function(e,t){},799:function(e,t,a){"use strict";var s=a(62),i=a(160);t.a={name:"mu-radio",props:{name:{type:String},value:{type:String},nativeValue:{type:String},label:{type:String,default:""},labelLeft:{type:Boolean,default:!1},labelClass:{type:[String,Object,Array]},disabled:{type:Boolean,default:!1},uncheckIcon:{type:String,default:""},checkedIcon:{type:String,default:""},iconClass:{type:[String,Object,Array]}},data:function(){return{inputValue:this.value}},watch:{value:function(e){this.inputValue=e},inputValue:function(e){this.$emit("input",e)}},methods:{handleClick:function(){},handleMouseDown:function(e){this.disabled||0===e.button&&this.$children[0].start(e)},handleMouseUp:function(){this.disabled||this.$children[0].end()},handleMouseLeave:function(){this.disabled||this.$children[0].end()},handleTouchStart:function(e){this.disabled||this.$children[0].start(e)},handleTouchEnd:function(){this.disabled||this.$children[0].end()},handleChange:function(){this.$emit("change",this.inputValue)}},components:{icon:s.a,"touch-ripple":i.a}}},800:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("label",{staticClass:"mu-radio",class:{"label-left":e.labelLeft,disabled:e.disabled,"no-label":!e.label},on:{mousedown:e.handleMouseDown,mouseleave:e.handleMouseLeave,mouseup:e.handleMouseUp,touchstart:e.handleTouchStart,touchend:e.handleTouchEnd,touchcancel:e.handleTouchEnd,click:function(t){t.stopPropagation(),e.handleClick(t)}}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.inputValue,expression:"inputValue"}],attrs:{type:"radio",disabled:e.disabled,name:e.name},domProps:{value:e.nativeValue,checked:e._q(e.inputValue,e.nativeValue)},on:{change:[function(t){e.inputValue=e.nativeValue},e.handleChange]}}),e._v(" "),e.disabled?e._e():a("touch-ripple",{staticClass:"mu-radio-wrapper",attrs:{rippleWrapperClass:"mu-radio-ripple-wrapper"}},[e.label&&e.labelLeft?a("div",{staticClass:"mu-radio-label",class:e.labelClass},[e._v(e._s(e.label))]):e._e(),e._v(" "),a("div",{staticClass:"mu-radio-icon"},[e.checkedIcon?e._e():a("svg",{staticClass:"mu-radio-icon-uncheck mu-radio-svg-icon",class:e.iconClass,attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}})]),e._v(" "),e.uncheckIcon?e._e():a("svg",{staticClass:"mu-radio-icon-checked mu-radio-svg-icon",class:e.iconClass,attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}})]),e._v(" "),e.uncheckIcon?a("icon",{staticClass:"mu-radio-icon-uncheck",class:e.iconClass,attrs:{value:e.uncheckIcon}}):e._e(),e._v(" "),e.checkedIcon?a("icon",{staticClass:"mu-radio-icon-checked",class:e.iconClass,attrs:{value:e.checkedIcon}}):e._e()],1),e._v(" "),e.label&&!e.labelLeft?a("div",{staticClass:"mu-radio-label",class:e.labelClass},[e._v(e._s(e.label))]):e._e()]),e._v(" "),e.disabled?a("div",{staticClass:"mu-radio-wrapper"},[e.label&&e.labelLeft?a("div",{staticClass:"mu-radio-label",class:e.labelClass},[e._v(e._s(e.label))]):e._e(),e._v(" "),a("div",{staticClass:"mu-radio-icon"},[e.checkedIcon?e._e():a("svg",{staticClass:"mu-radio-icon-uncheck mu-radio-svg-icon",class:e.iconClass,attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}})]),e._v(" "),e.uncheckIcon?e._e():a("svg",{staticClass:"mu-radio-icon-checked mu-radio-svg-icon",class:e.iconClass,attrs:{viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}})]),e._v(" "),e.uncheckIcon?a("icon",{staticClass:"mu-radio-icon-uncheck",class:e.iconClass,attrs:{value:e.uncheckIcon}}):e._e(),e._v(" "),e.checkedIcon?a("icon",{staticClass:"mu-radio-icon-checked",class:e.iconClass,attrs:{value:e.checkedIcon}}):e._e()],1),e._v(" "),e.label&&!e.labelLeft?a("div",{staticClass:"mu-radio-label",class:e.labelClass},[e._v(e._s(e.label))]):e._e()]):e._e()],1)},i=[];s._withStripped=!0;var n={render:s,staticRenderFns:i};t.a=n},801:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content",attrs:{id:"comment-view"}},[a("div",{ref:"commentListContainer",staticClass:"commentContainer"},[a("mu-refresh-control",{attrs:{refreshing:e.refreshingData,trigger:e.commentListContainer},on:{refresh:e.refreshData}}),e._v(" "),a("div",{staticClass:"content-scroll"},[e.userInfo?a("div",{staticClass:"header-content"},[a("load-img",{staticClass:"header-avatar",attrs:{type:"img",url:e.userInfo.headPortrait}}),e._v(" "),e.topFriendImpression?a("div",{staticClass:"tags-area"},[0===e.topFriendImpression.tags.length?a("div",{staticClass:"no-tags-hint"},[e._v("暂时还没有好友为Ta打标签")]):e._e(),e._v(" "),e.topFriendImpression.tags.length>0?a("div",{staticClass:"with-tags"},e._l(e.topFriendImpression.tags,function(t,s){return a("div",{key:s,class:["elemTags",e.tags()]},[a("i",{staticClass:"iconfont icon-circle-empty"}),e._v(e._s(t.value))])})):e._e()]):e._e()],1):e._e(),e._v(" "),e._l(e.commentList,function(t){return a("div",{key:t.id,staticClass:"content-list"},[a("div",{staticClass:"card-block"},[a("div",{staticClass:"imgage-box"},[a("load-img",{staticClass:"item-headportrait",attrs:{type:"img",url:t.headPortrait}})],1),e._v(" "),a("div",{staticClass:"item-info"},[a("div",{staticClass:"item-title"},[a("span",{staticClass:"title-left"},[e._v(e._s(t.realname.length>13?t.realname.substr(0,13)+"...":t.realname))]),e._v(" "),a("span",{class:["title-uprote",-1!==e.isInUpvotersList(t.upvoters)?"like-select":"like-unselect"]},[a("i",{staticClass:"iconfont icon-heart-pink",on:{click:function(a){e.changeLike(t.upvoters,t.id)}}},[e._v(e._s(null===t.upvoters?0:t.upvoters.length))])]),e._v(" "),a("span",{staticClass:"title-time"},[e._v(e._s(e._f("dateTrans")(t.createTime)))])]),e._v(" "),a("div",{staticClass:"item-body"},[t.tagsArray.length>0?a("div",{staticClass:"tags-wrap"},e._l(t.tagsArray,function(t,s){return a("div",{key:s,staticClass:"tag tag-selected"},[e._v(e._s(t))])})):e._e(),e._v(" "),a("div",{staticClass:"comment-content"},[e._v(e._s(t.content))])]),e._v(" "),e.isMe?a("div",{staticClass:"item-footer"},[3!==t.privacy?a("div",{staticClass:"setting-label",on:{click:function(a){e.openPrivacyModal(t)}}},[a("i",{staticClass:"iconfont icon-privacy-eye-big"},[e._v(e._s(e._f("privatySelect")(t.privacy)))])]):a("div",{staticClass:"setting-label"},[e._v("该点评仅您与评论用户可见")])]):e._e()])]),e._v(" "),a("div",{staticClass:"div-line-custom"})])})],2),e._v(" "),a("div",{staticStyle:{height:"20px"}}),e._v(" "),e.resPage.hasMore?a("mu-infinite-scroll",{attrs:{scroller:e.commentListContainer,loading:e.loadingData,loadingText:e.loadingText},on:{load:e.loadMoreData}}):e._e()],1),e._v(" "),!e.isMe&&e.isFriend?a("mu-float-button",{staticClass:"float-button",on:{click:function(t){e.routeToAddComment()}}},[e._v("添加点评")]):e._e(),e._v(" "),e.popupInCommentView?a("mu-popup",{attrs:{position:"bottom",popupClass:"modal",open:e.isShowModal},on:{close:function(t){e.closePrivacyModel()}}},[a("mu-radio",{staticClass:"radio-custom",attrs:{label:"公开可见",name:"privacyGroup",nativeValue:"0"},on:{change:function(t){e.udatePrivacy("0")}},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}}),e._v(" "),a("mu-radio",{staticClass:"radio-custom",attrs:{label:"仅好友可见",name:"privacyGroup",nativeValue:"1"},on:{change:function(t){e.udatePrivacy("1")}},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}}),e._v(" "),a("mu-radio",{staticClass:"radio-custom",attrs:{label:"仅自己可见",name:"privacyGroup",nativeValue:"2"},on:{change:function(t){e.udatePrivacy("2")}},model:{value:e.radioValue,callback:function(t){e.radioValue=t},expression:"radioValue"}})],1):e._e()],1)},i=[];s._withStripped=!0;var n={render:s,staticRenderFns:i};t.a=n}});
//# sourceMappingURL=5.3a31bdb2e0dd6f7645c1.js.map