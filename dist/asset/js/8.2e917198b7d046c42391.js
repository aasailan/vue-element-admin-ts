webpackJsonp([8],{563:function(t,e,n){"use strict";function o(t){r||n(768)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(769),a=n(771),r=!1,s=n(6),c=o,u=s(i.a,a.a,!1,c,null,null);u.options.__file="src\\pages\\authentication\\index.vue",u.esModule&&Object.keys(u.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)}),e.default=u.exports},584:function(t,e,n){t.exports=n.p+"/asset/imgs/weixiaobao4b8e1e830f46d01a7e6b0c07fbfa5b4e.png"},768:function(t,e){},769:function(t,e,n){"use strict";var o=n(12),i=n(55),a=n.n(i),r=n(110),s=n(25),c=n(60),u=n(770),p=n(61),l=n(576),h=n.n(l),d=n(578),f=n(36),y=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),v=this&&this.__decorate||function(t,e,n,o){var i,a=arguments.length,r=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(r=(a<3?i(r):a>3?i(e,n,r):i(e,n))||r);return a>3&&r&&Object.defineProperty(e,n,r),r},b=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},g=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,a){function r(t){try{c(o.next(t))}catch(t){a(t)}}function s(t){try{c(o.throw(t))}catch(t){a(t)}}function c(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(r,s)}c((o=o.apply(t,e||[])).next())})},_=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(r=a[2&n[0]?"return":n[0]?"throw":"next"])&&!(r=r.call(a,n[1])).done)return r;switch(a=0,r&&(n=[0,r.value]),n[0]){case 0:case 1:r=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(r=c.trys,!(r=r.length>0&&r[r.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!r||n[1]>r[0]&&n[1]<r[3])){c.label=n[1];break}if(6===n[0]&&c.label<r[1]){c.label=r[1],r=n;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(n);break}r[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(t){n=[6,t],a=0}finally{i=r=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,r,s,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isUploading=!1,e.resInfo="",e.isCroping=!1,e.myCroppaOption={fullScreen:!0,fromCamera:!0,compressionRate:.7,quality:6},e}return y(e,t),Object.defineProperty(e.prototype,"statusTxt",{get:function(){switch(this.authStatus){case u.a.SUCCESS:return"认证成功";case u.a.FAIL:return"认证失败！";case u.a.AUTHING:return"认证中";default:return""}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"upBtnTxt",{get:function(){switch(this.authStatus){case u.a.READY:return"继续认证";case u.a.FAIL:return"重新认证";case u.a.SUCCESS:case u.a.NEVER:case u.a.AUTHING:return"";case u.a.NEXT:return"继续认证";default:return""}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downBtnTxt",{get:function(){switch(this.authStatus){case u.a.READY:case u.a.FAIL:return"重新上传";case u.a.SUCCESS:return"";case u.a.NEVER:return"上传照片";case u.a.AUTHING:return"";case u.a.NEXT:return"重新上传";default:return""}},enumerable:!0,configurable:!0}),e.prototype.activated=function(){return g(this,void 0,void 0,function(){return _(this,function(t){switch(t.label){case 0:return this.isUploading=!1,this.isCroping=!1,[4,f.a.initedToken()];case 1:return t.sent(),this.getMyInfo(),this.getUserRoles(),[2]}})})},e.prototype.deactivated=function(){this.isUploading&&this.destoried(),this.isCroping&&this.hideCroppa()},e.prototype.clickUpBtn=function(){return g(this,void 0,void 0,function(){var t,e,n,o,i,a,r;return _(this,function(l){switch(l.label){case 0:return l.trys.push([0,3,,4]),this.authStatus!==u.a.NEXT&&this.authStatus!==u.a.FAIL?[3,2]:[4,p.a.authenticate()];case 1:t=l.sent(),e=t.body.obj.url,n=t.body.obj.bizNo,o={url:e,bizNo:n,statusCode:u.a.READY},this.updateAuthStatus(o),l.label=2;case 2:return i={url:this.authUrl,bizNo:this.bizNo},this.resInfo="",a=s.H+"/zhima/auth.html?url="+encodeURIComponent(this.authUrl),window.location.href=a,[3,4];case 3:return r=l.sent(),this.showToast(new c.a(r.message)),[3,4];case 4:return[2]}})})},e.prototype.selectPhoto=function(){this.isCroping=!0,this.$refs.croppa.chooseFile()},e.prototype.confirmCroppa=function(t){var e=this;this.showLoading();var n=s.X,o={"access-token":this.$store.state.token},i={base64Code:t.base64Code,type:t.type,filename:t.filename,filed:"idcard"};h()("POST",n,o,i,function(t){return g(e,void 0,void 0,function(){var e,n;return _(this,function(o){try{if(0!==(e=t.msgStatus))throw this.resInfo=t.msgText,new Error(t.msgText);this.showToast(new c.a("识别身份证成功")),this.resInfo="若信息有误请重新上传身份证图片",n={statusCode:u.a.NEXT,certNo:t.obj.certNo,name:t.obj.name},this.updateAuthStatus(n)}catch(t){this.showToast(new c.a(t.message))}finally{this.hideLoading(),this.hideCroppa()}return[2]})})},function(){e.showToast(new c.a("上传失败")),e.hideLoading(),e.hideCroppa()},!0,!0)},e.prototype.cancelCroppa=function(){this.hideCroppa()},e.prototype.hideCroppa=function(){this.$refs.croppa.hide(),this.isCroping=!1},v([Object(r.a)("showToast"),b("design:type",Object)],e.prototype,"showToast",void 0),v([Object(r.c)(function(t){return t.user.authentication}),b("design:type",Number)],e.prototype,"authentication",void 0),v([Object(r.c)(function(t){return t.user.auth.name}),b("design:type",String)],e.prototype,"authname",void 0),v([Object(r.c)(function(t){return t.user.auth.certNo}),b("design:type",String)],e.prototype,"certNo",void 0),v([Object(r.c)(function(t){return t.user.auth.statusCode}),b("design:type",Number)],e.prototype,"authStatus",void 0),v([Object(r.c)(function(t){return t.user.auth.url}),b("design:type",String)],e.prototype,"authUrl",void 0),v([Object(r.c)(function(t){return t.user.auth.bizNo}),b("design:type",String)],e.prototype,"bizNo",void 0),v([Object(r.a)("updateAuthStatus"),b("design:type",Object)],e.prototype,"updateAuthStatus",void 0),v([Object(r.a)("showLoading"),b("design:type",Object)],e.prototype,"showLoading",void 0),v([Object(r.a)("hideLoading"),b("design:type",Object)],e.prototype,"hideLoading",void 0),v([Object(r.a)("getUserRoles"),b("design:type",Object)],e.prototype,"getUserRoles",void 0),v([Object(r.a)("getMyInfo"),b("design:type",Object)],e.prototype,"getMyInfo",void 0),e=v([a()({components:{"my-croppa":d.a}})],e)}(o.default);e.a=m},770:function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o={READY:1,FAIL:2,SUCCESS:3,NEVER:-1,AUTHING:4,NEXT:0}},771:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"content",attrs:{id:"auth-index"}},[o("div",{staticClass:"hint"},[o("div",[t._v("提示：")]),t._v(" "),o("div",[t._v("1、您提交的资料仅作为本平台审查备案并严格保密，请放心填写。")]),t._v(" "),o("div",[t._v("2、为保障您的权益，请上传本人真实资料。")]),t._v(" "),3!==t.authStatus?o("div",[o("span",{staticStyle:{color:"#fe7777"}},[t._v("3、实名认证需要您上传您的身份证正面照，请按照如下方式拍摄上传您的身份证照片")])]):t._e(),t._v(" "),3!==t.authStatus?o("div",{staticClass:"hint-img"},[o("img",{staticClass:"iphone-img",attrs:{src:n(584)}})]):t._e()]),t._v(" "),""!==t.resInfo?o("div",{staticClass:"res-info"},[t._v("*"+t._s(t.resInfo))]):t._e(),t._v(" "),-1!==t.authStatus?o("div",{staticClass:"auth-content"},[o("div",{staticClass:"row"},[o("div",{staticClass:"col-20"},[t._v("姓名：")]),t._v(" "),o("div",{staticClass:"col-80"},[t._v(t._s(t.authname))])]),t._v(" "),o("div",{staticClass:"row"},[o("div",{staticClass:"col-20"},[t._v("身份证：")]),t._v(" "),o("div",{staticClass:"col-80"},[t._v(t._s(t.certNo))])])]):t._e(),t._v(" "),o("div",{staticClass:"button-content"},[t.statusTxt.length>0?o("div",{staticClass:"status"},[t._v(t._s(t.statusTxt))]):t._e(),t._v(" "),t.upBtnTxt.length>0?o("mu-raised-button",{staticClass:"demo-raised-button",attrs:{label:t.upBtnTxt,primary:"",fullWidth:""},on:{click:t.clickUpBtn}}):t._e(),t._v(" "),t.downBtnTxt.length>0?o("mu-raised-button",{staticClass:"demo-raised-button",attrs:{label:t.downBtnTxt,primary:"",fullWidth:""},on:{click:t.selectPhoto}}):t._e()],1),t._v(" "),o("my-croppa",{ref:"croppa",attrs:{option:t.myCroppaOption},on:{confirm:t.confirmCroppa,cancel:t.cancelCroppa}}),t._v(" "),o("img",{staticStyle:{display:"none"},attrs:{id:"auth-img"}})],1)},i=[];o._withStripped=!0;var a={render:o,staticRenderFns:i};e.a=a}});
//# sourceMappingURL=8.2e917198b7d046c42391.js.map