webpackJsonp([9],{571:function(t,a,e){"use strict";function n(t){o||e(802)}Object.defineProperty(a,"__esModule",{value:!0});var i=e(803),s=e(804),o=!1,r=e(6),u=n,l=r(i.a,s.a,!1,u,null,null);l.options.__file="src\\pages\\add_friendImpressions\\index.vue",l.esModule&&Object.keys(l.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)}),a.default=l.exports},591:function(t,a,e){"use strict";e.d(a,"b",function(){return n}),e.d(a,"a",function(){return i});var n=function(){function t(){this.content=null,this.tag0=null,this.tag1=null,this.tag2=null,this.tag3=null,this.tag4=null,this.tag5=null,this.privacy=null,this.uid=null}return t}(),i=function(){function t(t){for(var a in t)this[a]=t[a];this.tagsArray=[];for(var e=0;e<6;e++)null!==t["tag"+e]&&this.tagsArray.push(this["tag"+e])}return t}()},802:function(t,a){},803:function(t,a,e){"use strict";var n=e(12),i=e(55),s=e.n(i),o=e(110),r=e(575),u=e(583),l=e(591),c=e(60),h=e(61),p=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,a){t.__proto__=a}||function(t,a){for(var e in a)a.hasOwnProperty(e)&&(t[e]=a[e])};return function(a,e){function n(){this.constructor=a}t(a,e),a.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),d=this&&this.__decorate||function(t,a,e,n){var i,s=arguments.length,o=s<3?a:null===n?n=Object.getOwnPropertyDescriptor(a,e):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,a,e,n);else for(var r=t.length-1;r>=0;r--)(i=t[r])&&(o=(s<3?i(o):s>3?i(a,e,o):i(a,e))||o);return s>3&&o&&Object.defineProperty(a,e,o),o},v=this&&this.__metadata||function(t,a){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,a)},f=this&&this.__awaiter||function(t,a,e,n){return new(e||(e=Promise))(function(i,s){function o(t){try{u(n.next(t))}catch(t){s(t)}}function r(t){try{u(n.throw(t))}catch(t){s(t)}}function u(t){t.done?i(t.value):new e(function(a){a(t.value)}).then(o,r)}u((n=n.apply(t,a||[])).next())})},g=this&&this.__generator||function(t,a){function e(t){return function(a){return n([t,a])}}function n(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,s&&(o=s[2&e[0]?"return":e[0]?"throw":"next"])&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[0,o.value]),e[0]){case 0:case 1:o=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,s=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(o=u.trys,!(o=o.length>0&&o[o.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){u.label=e[1];break}if(6===e[0]&&u.label<o[1]){u.label=o[1],o=e;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(e);break}o[2]&&u.ops.pop(),u.trys.pop();continue}e=a.call(t,u)}catch(t){e=[6,t],s=0}finally{i=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}var i,s,o,r,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},m=function(t){function a(){var a=null!==t&&t.apply(this,arguments)||this;return a.evaluationData={submitImpression:new l.b,tags:[],inputTags:null,selectCount:0,sex:null,isableCommit:!0,isableAddTags:!0,privacyCheck:!1},a.maxTagLength=6,a.paramsAddFriendImp=null,a.inputTagsErrorText="",a.contentInputErrorText="",a}return p(a,t),Object.defineProperty(a.prototype,"isableAddTags",{get:function(){return!!(this.evaluationData.inputTags&&this.evaluationData.inputTags.length>0&&this.evaluationData.inputTags.length<this.maxTagLength+1)},enumerable:!0,configurable:!0}),a.prototype.activated=function(){this.paramsAddFriendImp=this.$route.params,this.initData(),this.evaluationData.submitImpression.uid=this.paramsAddFriendImp.id,this.evaluationData.privacyCheck="fromFriendList"===this.paramsAddFriendImp.action,this.getEvaluationTags()},a.prototype.initData=function(){this.evaluationData={submitImpression:new l.b,tags:[],inputTags:null,selectCount:0,sex:null,isableCommit:!0,isableAddTags:!0,privacyCheck:!1},this.maxTagLength=6,this.inputTagsErrorText="",this.contentInputErrorText=""},a.prototype.getEvaluationTags=function(){return f(this,void 0,void 0,function(){var t,a,e,n=this;return g(this,function(i){switch(i.label){case 0:this.showLoading(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,h.a.getImpressionTagsBySex(this.paramsAddFriendImp.sex)];case 2:return t=i.sent(),this.hideLoading(),a=t.body.obj.characterTagss,a.forEach(function(t){n.evaluationData.tags.push({text:t,selected:!1})}),[3,4];case 3:return e=i.sent(),this.hideLoading(),this.showToast(new c.a(e.message)),[3,4];case 4:return[2]}})})},a.prototype.toggleTag=function(t){t.selected?(this.evaluationData.selectCount-=1,t.selected=!t.selected):this.evaluationData.selectCount>=6?this.showToast(new c.a("印象标签最多只能选6个")):(this.evaluationData.selectCount+=1,t.selected=!t.selected)},a.prototype.addEvaluationTag=function(){if(this.evaluationData.inputTags&&""!==this.evaluationData.inputTags)if(this.evaluationData.selectCount>=6)this.showToast(new c.a("印象标签最多只能选6个"));else{var t,a=void 0;for(a=0,t=this.evaluationData.tags.length;a<t;a++)if(this.evaluationData.inputTags===this.evaluationData.tags[a].text){this.evaluationData.tags[a].selected=!0;break}a===t&&this.evaluationData.tags.unshift({text:this.evaluationData.inputTags,selected:!0}),this.evaluationData.selectCount+=1,this.evaluationData.inputTags=null}},a.prototype.handleInputTagsOverflow=function(t){this.evaluationData.isableAddTags=!t},a.prototype.handleContentOverflow=function(t){this.contentInputErrorText=t?"超过字数限制啦！":"",this.evaluationData.isableCommit=!t},a.prototype.confirmBack=function(){var t={id:this.paramsAddFriendImp.id,action:this.paramsAddFriendImp.action};this.$router.replace({name:"commentView",params:t})},a.prototype.cancelEvalation=function(){history.back()},a.prototype.confirmEvalation=function(){return f(this,void 0,void 0,function(){var t,a,e,e,n,i;return g(this,function(s){switch(s.label){case 0:return null!==this.evaluationData.submitImpression.content&&""!==this.evaluationData.submitImpression.content?[3,1]:(this.showToast(new c.a("请输入一句话评论")),[3,5]);case 1:for(t=null,a=0,e=0;e<this.evaluationData.tags.length;e++)t=this.evaluationData.tags[e],t.selected&&(this.evaluationData.submitImpression["tag"+a]=t.text,a++);if(a<6)for(e=a;e<6;e++)this.evaluationData.submitImpression["tag"+a]=null,a++;this.evaluationData.privacyCheck&&(this.evaluationData.submitImpression.privacy=3),this.showLoading(),s.label=2;case 2:return s.trys.push([2,4,,5]),[4,h.a.commitNewSentences(this.evaluationData.submitImpression)];case 3:return n=s.sent(),this.hideLoading(),this.evaluationData.tags=[],this.evaluationData.inputTags="",this.evaluationData.submitImpression.content=null,this.confirmBack(),[3,5];case 4:return i=s.sent(),this.hideLoading(),this.showToast(new c.a(i.message)),[3,5];case 5:return[2]}})})},d([Object(o.a)("showToast"),v("design:type",Object)],a.prototype,"showToast",void 0),d([Object(o.a)("showLoading"),v("design:type",Object)],a.prototype,"showLoading",void 0),d([Object(o.a)("hideLoading"),v("design:type",Object)],a.prototype,"hideLoading",void 0),a=d([s()({components:{"mu-text-field":r.a,"mu-checkbox":u.a}})],a)}(n.default);a.a=m},804:function(t,a,e){"use strict";var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"content",attrs:{id:"add-evalation"}},[e("div",[e("div",{staticClass:"row title-font"},[t._v("对TA的印象：")]),t._v(" "),e("div",{staticClass:"row"},[e("div",{staticClass:"tags-wrap"},t._l(t.evaluationData.tags,function(a,n){return e("div",{key:n,class:["tag",a.selected?"tag-selected":"tag-wait"],on:{click:function(e){t.toggleTag(a)}}},[t._v("\n                    "+t._s(a.text)+"\n                ")])}))]),t._v(" "),e("div",{staticClass:"custom-tag"},[e("mu-text-field",{staticClass:"add-input",attrs:{hintText:"最多输入6个字",maxLength:t.maxTagLength,errorText:t.inputTagsErrorText},on:{textOverflow:t.handleInputTagsOverflow},model:{value:t.evaluationData.inputTags,callback:function(a){t.$set(t.evaluationData,"inputTags",a)},expression:"evaluationData.inputTags"}}),t._v(" "),e("mu-raised-button",{class:t.isableAddTags?"active":"",attrs:{label:"+添加",disabled:!t.isableAddTags},on:{click:function(a){t.addEvaluationTag()}}})],1),t._v(" "),e("div",{staticClass:"row title-font",staticStyle:{"margin-top":"10px"}},[t._v("一句话评价TA：")]),t._v(" "),e("div",{staticClass:"row"},[e("mu-text-field",{staticClass:"content-input",attrs:{hintText:null===t.evaluationData.submitImpression.content?"例如：他很帅":""===t.evaluationData.submitImpression.content?"请输入至少一字":null,maxLength:140,multiLine:"",rowsMax:5,errorText:t.contentInputErrorText},on:{textOverflow:t.handleContentOverflow},model:{value:t.evaluationData.submitImpression.content,callback:function(a){t.$set(t.evaluationData.submitImpression,"content",a)},expression:"evaluationData.submitImpression.content"}})],1),t._v(" "),e("mu-checkbox",{attrs:{label:"私密点评（该点评仅您与此用户可见）",labelClass:"privacy-checkbox"},model:{value:t.evaluationData.privacyCheck,callback:function(a){t.$set(t.evaluationData,"privacyCheck",a)},expression:"evaluationData.privacyCheck"}})],1),t._v(" "),e("div",{staticClass:"bottom-button"},[e("mu-raised-button",{attrs:{label:"取消"},on:{click:function(a){t.cancelEvalation()}}}),t._v(" "),e("mu-raised-button",{staticClass:"submit-button",attrs:{label:"提交",disabled:!t.evaluationData.isableCommit},on:{click:function(a){t.confirmEvalation()}}})],1)])},i=[];n._withStripped=!0;var s={render:n,staticRenderFns:i};a.a=s}});
//# sourceMappingURL=9.deeb2374259beabc9616.js.map