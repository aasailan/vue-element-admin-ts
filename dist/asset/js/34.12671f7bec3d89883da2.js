webpackJsonp([34],{532:function(t,e,s){"use strict";function a(t){r||s(623)}Object.defineProperty(e,"__esModule",{value:!0});var i=s(624),n=s(629),r=!1,o=s(6),c=a,u=o(i.a,n.a,!1,c,null,null);u.options.__file="src\\pages\\link\\index.vue",u.esModule&&Object.keys(u.esModule).some(function(t){return"default"!==t&&"__"!==t.substr(0,2)}),e.default=u.exports},623:function(t,e){},624:function(t,e,s){"use strict";var a=s(25),i=s(12),n=s(55),r=s.n(n),o=s(110),c=s(581),u=s(582),l=s(25),d=s(60),h=s(61),v=s(36),p=s(111),f=s(112),k=(s.n(f),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])};return function(e,s){function a(){this.constructor=e}t(e,s),e.prototype=null===s?Object.create(s):(a.prototype=s.prototype,new a)}}()),T=this&&this.__decorate||function(t,e,s,a){var i,n=arguments.length,r=n<3?e:null===a?a=Object.getOwnPropertyDescriptor(e,s):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,s,a);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(r=(n<3?i(r):n>3?i(e,s,r):i(e,s))||r);return n>3&&r&&Object.defineProperty(e,s,r),r},m=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},b=this&&this.__awaiter||function(t,e,s,a){return new(s||(s=Promise))(function(i,n){function r(t){try{c(a.next(t))}catch(t){n(t)}}function o(t){try{c(a.throw(t))}catch(t){n(t)}}function c(t){t.done?i(t.value):new s(function(e){e(t.value)}).then(r,o)}c((a=a.apply(t,e||[])).next())})},g=this&&this.__generator||function(t,e){function s(t){return function(e){return a([t,e])}}function a(s){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,n&&(r=n[2&s[0]?"return":s[0]?"throw":"next"])&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[0,r.value]),s[0]){case 0:case 1:r=s;break;case 4:return c.label++,{value:s[1],done:!1};case 5:c.label++,n=s[1],s=[0];continue;case 7:s=c.ops.pop(),c.trys.pop();continue;default:if(r=c.trys,!(r=r.length>0&&r[r.length-1])&&(6===s[0]||2===s[0])){c=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){c.label=s[1];break}if(6===s[0]&&c.label<r[1]){c.label=r[1],r=s;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(s);break}r[2]&&c.ops.pop(),c.trys.pop();continue}s=e.call(t,c)}catch(t){s=[6,t],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}var i,n,r,o,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.pageSize=10,e.loadingText=l.w,e.isActiveModal=!1,e.swiperOpt=new(function(){function t(t){this.superThis=t,this.on={},this.touchAngle=20,this.iOSEdgeSwipeDetection=!0,this.shortSwipes=!0,this.on.slideChangeTransitionEnd=function(){t.changeTab(""+this.activeIndex,!1),t.setWXShareByTab(""+this.activeIndex)}}return t}())(e),e.activeTabIndex="0",e.matchTaskListContainer=null,e.refreshingMatchTask=!1,e.loadingMatchTask=!1,e.matchTaskPage={hasMore:!1,curPage:1},e.matchTaskList=[],e.receivedTaskListContainer=null,e.refreshingReceivedTask=!1,e.loadingReceivedTask=!1,e.receivedTaskPage={hasMore:!1,curPage:1},e.receivedTaskList=[],e.redPackeStatus="close",e.receivingTask=null,e.receivedTaskInviteCode=null,e}return k(e,t),Object.defineProperty(e.prototype,"swiper",{get:function(){return this.$refs.linkSwiper.swiper},enumerable:!0,configurable:!0}),e.prototype.mounted=function(){this.matchTaskListContainer=this.$refs.matchTaskListContainer,this.receivedTaskListContainer=this.$refs.receivedTaskListContainer},e.prototype.activated=function(){return b(this,void 0,void 0,function(){return g(this,function(t){switch(t.label){case 0:return this.isActiveModal=!0,this.updateTabValue("link"),[4,v.a.initedUser()];case 1:return t.sent(),this.refreshMatchTask(),this.refreshReceivedTask(),this.initWX(),[2]}})})},e.prototype.deactivated=function(){this.isActiveModal=!1,this.isShowModal&&this.hideModal()},e.prototype.initWX=function(){return b(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return t=this,[4,v.a.initWX(a.t.ADD_FRIEND)];case 1:return t.receivedTaskInviteCode=e.sent(),this.setWXShareByTab(this.activeTabIndex),[2]}})})},e.prototype.setWXShareByTab=function(t){var e,s,i,n;"0"===t?(e=v.a.getShareUrl("/tab/link"),s=a.T+this.myInfo.realname,i=a.L,n=v.a.getThumbnailImg(this.myInfo.headPortrait)):(e=v.a.getShareUrl("/tab/link",this.receivedTaskInviteCode),s=a.Q+this.myInfo.realname,i=a.J,n=v.a.getThumbnailImg(this.myInfo.headPortrait)),v.a.setWXShareConfig(e,s,i,n)},e.prototype.changeTab=function(t,e){void 0===e&&(e=!0),this.activeTabIndex=t,e&&this.swiper.slideTo(parseInt(t,10))},e.prototype.isRedPacketEnable=function(t){for(var e=0,s=t;e<s.length;e++){var a=s[e];0===a.outOfReceiveTime?a.enableReceive=!1:0===a.currentCount?a.enableReceive=!1:0===a.subsetTasks.length?a.enableReceive=!0:a.enableReceive=!1}},e.prototype.clickMatchTask=function(t){var e={action:"redLine",id:t.fromUid};this.$router.push({name:"personalPage",params:e})},e.prototype.receiveTask=function(t,e){if(1===e.invalid){if(e.fromUid===this.myInfo.uid)return void this.showToast(new d.a("无法领取自己的红包!"));this.receivingTask=e,this.addModal(l.D)}},e.prototype.closeModel=function(){this.redPackeStatus="close",this.isShowModal&&this.hideModal()},e.prototype.openRedPacket=function(t){return b(this,void 0,void 0,function(){var e,s,a,i,n=this;return g(this,function(r){switch(r.label){case 0:this.redPackeStatus="opening",e=t.target,e.classList.add("rotate"),s=!1,r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,h.a.receiveTask(this.receivingTask.taskId,this.receivingTask.taskType)];case 2:return a=r.sent(),v.a.saveItem(p.a.redpacketDetail+this.receivingTask.taskId,a.body.obj),s=!0,[3,5];case 3:return i=r.sent(),this.showToast(new d.a(i.message)),[3,5];case 4:return Object(f.setTimeout)(function(){e.classList.remove("rotate"),n.redPackeStatus="close",s&&(n.receivingTask.enableReceive=!1,n.closeModel(),Object(f.setTimeout)(function(){var t={taskId:n.receivingTask.taskId};n.$router.push({name:"redpackDetail",params:t})},20))},1e3),[7];case 5:return[2]}})})},e.prototype.refreshMatchTask=function(){return b(this,void 0,void 0,function(){var t,e,s;return g(this,function(a){switch(a.label){case 0:this.refreshingMatchTask=!0,a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,h.a.getMatchTasks(1,this.pageSize)];case 2:return t=a.sent(),this.matchTaskList=t.body.obj.rows,e=t.body.obj.page,v.a.checkPage(this.matchTaskPage,e),[3,5];case 3:return s=a.sent(),this.showToast(new d.a(s.message)),[3,5];case 4:return this.refreshingMatchTask=!1,[7];case 5:return[2]}})})},e.prototype.loadMoreMatchTask=function(){return b(this,void 0,void 0,function(){var t,e,s,a;return g(this,function(i){switch(i.label){case 0:this.loadingMatchTask=!0,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,h.a.getMatchTasks(this.matchTaskPage.curPage+1,this.pageSize)];case 2:return t=i.sent(),e=t.body.obj.rows,this.matchTaskList=this.matchTaskList.concat(e),s=t.body.obj.page,v.a.checkPage(this.matchTaskPage,s),[3,5];case 3:return a=i.sent(),this.showToast(new d.a(a.message)),this.matchTaskPage.hasMore=!1,[3,5];case 4:return this.loadingMatchTask=!1,[7];case 5:return[2]}})})},e.prototype.refreshReceivedTask=function(){return b(this,void 0,void 0,function(){var t,e,s;return g(this,function(a){switch(a.label){case 0:this.refreshingReceivedTask=!0,a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,h.a.getReceivedTasks(1,this.pageSize)];case 2:return t=a.sent(),this.receivedTaskList=t.body.obj.rows,e=t.body.obj.page,v.a.checkPage(this.receivedTaskPage,e),[3,5];case 3:return s=a.sent(),this.showToast(new d.a(s.message)),[3,5];case 4:return this.refreshingReceivedTask=!1,[7];case 5:return[2]}})})},e.prototype.loadMoreReceivedTask=function(){return b(this,void 0,void 0,function(){var t,e,s,a;return g(this,function(i){switch(i.label){case 0:this.loadingReceivedTask=!0,i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,h.a.getReceivedTasks(this.receivedTaskPage.curPage+1,this.pageSize)];case 2:return t=i.sent(),e=t.body.obj.rows,this.receivedTaskList=this.receivedTaskList.concat(e),s=t.body.obj.page,v.a.checkPage(this.receivedTaskPage,s),[3,5];case 3:return a=i.sent(),this.showToast(new d.a(a.message)),this.receivedTaskPage.hasMore=!1,[3,5];case 4:return this.loadingReceivedTask=!1,[7];case 5:return[2]}})})},e.prototype.toRecommendPage=function(t,e){if(0===e.subsetTasks[0].taskStatus){var s={action:"task",uid:e.fromUid,subId:e.subsetTasks[0].subId};this.$router.push({name:"recommend",params:s})}t.stopPropagation()},e.prototype.clickReceivedTask=function(t,e){if("userPage"===t.target.getAttribute("data-action")){var s={action:"otherUser",id:e.fromUid};this.$router.push({name:"personalPage",params:s})}else{var s={taskId:e.taskId};this.$router.push({name:"receivedTaskDetail",params:s})}},e.prototype.clearTask=function(t,e){return b(this,void 0,void 0,function(){var s,a,i;return g(this,function(n){switch(n.label){case 0:if(0!==(s=e.subsetTasks[0].clearingStatus)&&-1!==s)return[3,5];if(null===this.alipayId)return this.showToast(new d.a("您未绑定支付宝账户，请先绑定支付宝账户。")),this.$router.push({name:"bindAlipay"}),[2];if(-1===this.myRoles.indexOf(l.Y.authorized_matchmaker))return this.showToast(new d.a("您未认证，暂时无法领取红包，请先完成认证。")),this.$router.push({name:"authIndex"}),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,h.a.clearTask(e.subsetTasks[0].subId,1)];case 2:return a=n.sent(),this.showToast(new d.a("申请结算成功，红包将在24小时内发放至您的支付宝账户！")),[3,4];case 3:return i=n.sent(),this.showToast(new d.a(i.message)),[3,4];case 4:return[3,6];case 5:1===s?this.showToast(new d.a("金额结算中")):this.showToast(new d.a("金额已结算")),n.label=6;case 6:return t.stopPropagation(),[2]}})})},T([Object(o.c)(function(t){return t.modal.MODAL_0}),m("design:type",Object)],e.prototype,"isShowModal",void 0),T([Object(o.c)(function(t){return t.user.aliPaymentId}),m("design:type",String)],e.prototype,"alipayId",void 0),T([Object(o.c)(function(t){return t.user.roles}),m("design:type",Array)],e.prototype,"myRoles",void 0),T([Object(o.c)(function(t){return t.user.user}),m("design:type",Object)],e.prototype,"myInfo",void 0),T([Object(o.a)("updateTabValue"),m("design:type",Object)],e.prototype,"updateTabValue",void 0),T([Object(o.a)("addModal"),m("design:type",Object)],e.prototype,"addModal",void 0),T([Object(o.a)("hideModal"),m("design:type",Object)],e.prototype,"hideModal",void 0),T([Object(o.a)("showToast"),m("design:type",Object)],e.prototype,"showToast",void 0),e=T([r()({components:{"mu-float-button":c.a,"mu-popup":u.a}})],e)}(i.default);e.a=y},629:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content has-tabs",attrs:{id:"link-view"}},[s("mu-paper",{attrs:{zDepth:1}},[s("mu-tabs",{attrs:{value:t.activeTabIndex},on:{change:t.changeTab}},[s("mu-tab",{attrs:{value:"0",title:"悬赏榜"}}),t._v(" "),s("mu-tab",{attrs:{value:"1",title:"红娘榜"}})],1)],1),t._v(" "),s("swiper",{ref:"linkSwiper",attrs:{options:t.swiperOpt}},[s("swiper-slide",[s("div",{ref:"matchTaskListContainer",staticClass:"list-container has-bottom-tabs"},[s("mu-refresh-control",{attrs:{refreshing:t.refreshingMatchTask,trigger:t.matchTaskListContainer},on:{refresh:t.refreshMatchTask}}),t._v(" "),s("mu-list",[0===t.matchTaskList.length?s("mu-list-item",[s("div",{staticClass:"recommend-card"},[s("div",{staticClass:"no-recommend-hint"},[t._v(" 暂时没有悬赏任务！")])])]):t._e(),t._v(" "),t._l(t.matchTaskList,function(e){return s("mu-list-item",{key:e.taskId,attrs:{disableRipple:""},on:{click:function(s){t.clickMatchTask(e)}}},[s("div",{staticClass:"recommend-card"},[s("load-img",{staticClass:"headPortrait",attrs:{type:"div",url:e.fromUser.headPortrait}}),t._v(" "),s("div",{staticClass:"info-content"},[s("div",{staticClass:"name"},[t._v(t._s(e.fromUser.realname))]),t._v(" "),s("div",{staticClass:"info"},[t._v(t._s(e.leaveMsg))]),t._v(" "),s("div",{staticClass:"info-kickback"},[s("i",{staticClass:"iconfont icon-kickback"}),t._v(t._s(t._f("taskAmount")(e.totalAmount)))]),t._v(" "),s("div",{staticClass:"recommond-score"},[t._v("共"+t._s(e.totalCount)+"个红包"),2===e.taskType?s("span",[t._v(", 剩"+t._s(e.currentCount)+"个")]):t._e()]),t._v(" "),s("div",{staticClass:"button-raised kickback-button",class:{unable:1!==e.invalid},on:{click:function(s){s.stopPropagation(),t.receiveTask(s,e)}}},[t._v(t._s(1===e.taskType?"收":"抢"))])])],1)])})],2),t._v(" "),s("div",{staticStyle:{height:"20px"}}),t._v(" "),t.matchTaskPage.hasMore?s("mu-infinite-scroll",{attrs:{scroller:t.matchTaskListContainer,loading:t.loadingMatchTask,loadingText:t.loadingText},on:{load:t.loadMoreMatchTask}}):t._e()],1)]),t._v(" "),s("swiper-slide",[s("div",{ref:"receivedTaskListContainer",staticClass:"list-container has-bottom-tabs"},[s("mu-refresh-control",{attrs:{refreshing:t.refreshingReceivedTask,trigger:t.receivedTaskListContainer},on:{refresh:t.refreshReceivedTask}}),t._v(" "),s("mu-list",[0===t.receivedTaskList.length?s("mu-list-item",[s("div",{staticClass:"recommend-card"},[s("div",{staticClass:"no-recommend-hint"},[t._v("暂时没有月老簿任务")])])]):t._e(),t._v(" "),t._l(t.receivedTaskList,function(e){return s("mu-list-item",{key:e.taskId,attrs:{disableRipple:""},on:{click:function(s){t.clickReceivedTask(s,e)}}},[s("div",{staticClass:"content-box"},[s("div",{staticClass:"task-content"},[s("load-img",{staticClass:"avatar",attrs:{type:"div",url:e.fromUser.headPortrait,"data-action":"userPage"}}),t._v(" "),s("div",{staticClass:"task-detail"},[s("div",{staticClass:"head-info"},[s("div",{staticClass:"one-line-ellipsis col-33 name"},[s("nobr",[t._v(t._s(e.fromUser.realname))])],1),t._v(" "),s("div",{staticClass:"col-33 price"},[s("i",{staticClass:"iconfont icon-match-maker-price"},[t._v(t._s(t._f("taskAmount")(e.subsetTasks[0].amount)))])]),t._v(" "),s("div",{staticClass:"col-33 status"},[t._v(t._s(t._f("taskStatus")(e)))])]),t._v(" "),s("div",{staticClass:"leave-msg"},[t._v("留言："+t._s(e.leaveMsg))]),t._v(" "),s("div",{staticClass:"deadline"},[t._v("截止时间："+t._s(e.subsetTasks[0].dueTime))])])],1),t._v(" "),s("div",{staticClass:"foot-content"},[s("div",{staticClass:"letter"},[s("span",{staticStyle:{padding:"5px 0"}},[t._v("已推荐：")]),t._v(" "),t._l(e.subsetTasks[0].letters,function(t){return s("load-img",{key:t.uid,staticClass:"avatar",attrs:{type:"img",url:t.headPortrait}})})],2),t._v(" "),4!==e.subsetTasks[0].taskStatus?s("div",{staticClass:"task-button",class:0===e.subsetTasks[0].taskStatus?"active":"close",on:{click:function(s){s.stopPropagation(),t.toRecommendPage(s,e)}}},[t._v("\n                  帮TA牵线\n                ")]):t._e(),t._v(" "),4===e.subsetTasks[0].taskStatus?s("div",{staticClass:"task-button",class:0===e.subsetTasks[0].clearingStatus?"active":"close",on:{click:function(s){s.stopPropagation(),t.clearTask(s,e)}}},[t._v("\n                  收款\n                ")]):t._e()])])])})],2),t._v(" "),s("div",{staticStyle:{height:"20px"}}),t._v(" "),t.receivedTaskPage.hasMore?s("mu-infinite-scroll",{attrs:{scroller:t.receivedTaskListContainer,loading:t.loadingReceivedTask,loadingText:t.loadingText},on:{load:t.loadMoreReceivedTask}}):t._e()],1)])],1),t._v(" "),s("mu-float-button",{staticClass:"float-button",attrs:{to:{name:"recommend",params:{action:"custom",uid:"0",subId:"0"}}}},[t._v("牵线")]),t._v(" "),t.isActiveModal?s("mu-popup",{attrs:{position:"bottom",popupClass:"red-packet-popup",open:t.isShowModal},on:{close:function(e){t.closeModel()}}},[s("div",{staticClass:"draw-img"},[s("div",{staticClass:"draw-up"}),t._v(" "),s("div",{staticClass:"draw-up-up turn",attrs:{id:"draw-up-up"}}),t._v(" "),s("div",{staticClass:"draw-mid",on:{click:function(e){"close"===t.redPackeStatus&&t.openRedPacket(e)}}}),t._v(" "),s("div",{staticClass:"draw-down"}),t._v(" "),s("div",{staticClass:"draw-down2",staticStyle:{opacity:"0"}})])]):t._e()],1)},i=[];a._withStripped=!0;var n={render:a,staticRenderFns:i};e.a=n}});
//# sourceMappingURL=34.12671f7bec3d89883da2.js.map